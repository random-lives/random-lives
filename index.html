---
layout: default
title: Home
---

<div class="home">
  <h1>Random Lives</h1>
  <p class="intro">
    Biographical stories of randomly sampled people from across all of human history,
    weighted by actual birth numbers. Explore lives from 200,000 BCE to present.
  </p>

  <div class="filters">
    <h3>Filter by:</h3>
    <div class="filter-row">
      <label>
        Born after:
        <input type="text" id="filter-year-start" placeholder="e.g. 10000 BC" style="width: 100px;">
      </label>

      <label>
        Born before:
        <input type="text" id="filter-year-end" placeholder="e.g. 500 AD" style="width: 100px;">
      </label>

      <label>
        Continent:
        <select id="filter-continent">
          <option value="">All Continents</option>
          <option value="Africa">Africa</option>
          <option value="Asia">Asia</option>
          <option value="Europe">Europe</option>
          <option value="North America">North America</option>
          <option value="South America">South America</option>
          <option value="Oceania">Oceania</option>
        </select>
      </label>

      <label>
        Age at Death:
        <select id="filter-age">
          <option value="">All Ages</option>
          <option value="Alive">Alive</option>
          <option value="Infant (0–1)">Infant (0–1)</option>
          <option value="Child (2–10)">Child (2–10)</option>
          <option value="Adolescent (11–18)">Adolescent (11–18)</option>
          <option value="Adult (19–49)">Adult (19–49)</option>
          <option value="Elder (50+)">Elder (50+)</option>
        </select>
      </label>

      <label>
        Sex:
        <select id="filter-sex">
          <option value="">All</option>
          <option value="M">Male</option>
          <option value="F">Female</option>
        </select>
      </label>

      <label>
        Lifestyle:
        <select id="filter-lifestyle">
          <option value="">All Lifestyles</option>
          <option value="Hunter-Gatherer">Hunter-Gatherer</option>
          <option value="Rural">Rural</option>
          <option value="Urban">Urban</option>
        </select>
      </label>
    </div>
    <div class="filter-stats">
      Showing <span id="visible-count">0</span> of <span id="total-count">0</span> lives
    </div>
  </div>

  <div class="lives-list">
    <h2>Lives</h2>
    {% assign sorted_lives = site.lives | sort: "birth_year_numeric" %}
    {% for life in sorted_lives %}
      <article class="life-preview"
               data-birth-year="{{ life.birth_year_numeric }}"
               data-birth-year-str="{{ life.birth_year }}"
               data-continent="{{ life.continent }}"
               data-age="{{ life.age_tag }}"
               data-sex="{{ life.sex }}"
               data-lifestyle="{{ life.lifestyle }}"
               data-country="{{ life.country }}">
        <h3><a href="{{ life.url | relative_url }}">{{ life.title }}</a></h3>
        <div class="meta">
          <span class="years">{% if life.birth_year == life.death_year %}{{ life.birth_year }}{% else %}{{ life.birth_year }} – {{ life.death_year }}{% endif %}</span>
          {% if life.region %}<span class="region">{{ life.region }}</span>{% endif %}
          {% if life.country %}<span class="country">{{ life.country }}</span>{% endif %}
          <span class="lifestyle">{{ life.lifestyle }}</span>
        </div>
        <p class="excerpt">{{ life.excerpt | strip_html | truncatewords: 50 }}</p>
      </article>
    {% endfor %}
  </div>
</div>

<script>
(function() {
  const filters = {
    yearStart: document.getElementById('filter-year-start'),
    yearEnd: document.getElementById('filter-year-end'),
    continent: document.getElementById('filter-continent'),
    age: document.getElementById('filter-age'),
    sex: document.getElementById('filter-sex'),
    lifestyle: document.getElementById('filter-lifestyle')
  };

  const articles = document.querySelectorAll('.life-preview');
  const visibleCount = document.getElementById('visible-count');
  const totalCount = document.getElementById('total-count');

  totalCount.textContent = articles.length;

  // Parse year string like "500 AD", "10000 BC", "1990" into numeric year
  function parseYear(str) {
    if (!str || !str.trim()) return null;
    str = str.trim().toUpperCase();

    // Handle plain numbers (assume AD if positive)
    const plainNum = parseInt(str, 10);
    if (!isNaN(plainNum) && str.match(/^-?\d+$/)) {
      return plainNum;
    }

    // Handle "X BC" or "X BCE"
    const bcMatch = str.match(/^(\d+)\s*(BC|BCE)$/i);
    if (bcMatch) {
      return -parseInt(bcMatch[1], 10);
    }

    // Handle "X AD" or "X CE"
    const adMatch = str.match(/^(\d+)\s*(AD|CE)$/i);
    if (adMatch) {
      return parseInt(adMatch[1], 10);
    }

    return null;
  }

  // Get birth year for an article (numeric or parsed from string)
  function getBirthYear(article) {
    let birthYear = parseInt(article.dataset.birthYear, 10);
    if (isNaN(birthYear)) {
      birthYear = parseYear(article.dataset.birthYearStr);
    }
    return birthYear;
  }

  // Sort articles by birth year (oldest first)
  const livesList = document.querySelector('.lives-list');
  const articlesArray = Array.from(articles);
  articlesArray.sort((a, b) => {
    const yearA = getBirthYear(a);
    const yearB = getBirthYear(b);
    // Handle nulls - put them at the end
    if (yearA === null && yearB === null) return 0;
    if (yearA === null) return 1;
    if (yearB === null) return -1;
    return yearA - yearB;
  });
  // Re-append in sorted order
  articlesArray.forEach(article => livesList.appendChild(article));

  function applyFilters() {
    let visible = 0;

    const yearStart = parseYear(filters.yearStart.value);
    const yearEnd = parseYear(filters.yearEnd.value);

    articles.forEach(article => {
      const birthYear = getBirthYear(article);

      const matchYearStart = yearStart === null || birthYear === null || birthYear >= yearStart;
      const matchYearEnd = yearEnd === null || birthYear === null || birthYear <= yearEnd;
      const matchContinent = !filters.continent.value || article.dataset.continent === filters.continent.value;
      const matchAge = !filters.age.value || article.dataset.age === filters.age.value;
      const matchSex = !filters.sex.value || article.dataset.sex === filters.sex.value;
      const matchLifestyle = !filters.lifestyle.value || article.dataset.lifestyle === filters.lifestyle.value;

      if (matchYearStart && matchYearEnd && matchContinent && matchAge && matchSex && matchLifestyle) {
        article.style.display = '';
        visible++;
      } else {
        article.style.display = 'none';
      }
    });

    visibleCount.textContent = visible;
  }

  // Initial count
  applyFilters();

  // Add event listeners
  Object.values(filters).forEach(filter => {
    if (filter.tagName === 'INPUT') {
      filter.addEventListener('input', applyFilters);
    } else {
      filter.addEventListener('change', applyFilters);
    }
  });
})();
</script>
