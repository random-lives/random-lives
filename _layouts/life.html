---
layout: default
---

<article class="life">
  <header class="life-header {% if page.latitude and page.longitude %}life-header-with-map{% endif %}">
    <div class="life-info">
      <h1>{{ page.title }}</h1>
      <div class="life-meta">
        <p><strong>Born:</strong> {{ page.birth_date }}</p>
        {% if page.death_year != "present" %}<p><strong>Died:</strong> {{ page.death_date }} (Age {{ page.age_at_death }})</p>{% endif %}
        {% if page.location %}
          <p><strong>Birthplace:</strong>
            <a href="{{ page.map_url }}" target="_blank" rel="noopener noreferrer">
              {{ page.location }}
            </a>
          </p>
        {% elsif page.country %}
          <p><strong>Birthplace:</strong>
            <a href="{{ page.map_url }}" target="_blank" rel="noopener noreferrer">
              {{ page.country }}
            </a>
          </p>
        {% endif %}
        {% if page.lifestyle %}<p><strong>Lifestyle:</strong> {{ page.lifestyle }}</p>{% endif %}
      </div>
    </div>
    {% if page.latitude and page.longitude %}
    <div class="life-map">
      <div id="map"></div>
    </div>
    {% endif %}
  </header>

  {% if page.latitude and page.longitude %}
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script>
    (function() {
      // HYDE grid resolution: 5 arcminutes = ~9.2 km at equator = ~4.6 km radius
      const HYDE_RADIUS_METERS = 4600;
      const ZOOM_THRESHOLD = 8; // Show uncertainty circles at zoom 8+

      var map = L.map('map', {
        zoomControl: false,
        attributionControl: false,
        minZoom: 3,
        maxBounds: [[-85, -200], [85, 200]],
        maxBoundsViscosity: 1.0
      }).setView([{{ page.latitude }}, {{ page.longitude }}], 4);
      L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        maxZoom: 19
      }).addTo(map);

      // Circle marker (dot) for low zoom levels
      var dot = L.circleMarker([{{ page.latitude }}, {{ page.longitude }}], {
        radius: 6,
        fillColor: "#000",
        color: "#000",
        weight: 1,
        opacity: 1,
        fillOpacity: 1
      });

      // Circle (uncertainty region) for high zoom levels
      var circle = L.circle([{{ page.latitude }}, {{ page.longitude }}], {
        radius: HYDE_RADIUS_METERS,
        fillColor: "#000",
        color: "#fff",
        weight: 2,
        opacity: 1,
        fillOpacity: 0.3
      });

      // Start with dot visible
      dot.addTo(map);

      // Switch between dot and circle based on zoom level
      function updateMarkerDisplay() {
        const zoom = map.getZoom();
        const showCircle = zoom >= ZOOM_THRESHOLD;

        if (showCircle) {
          if (map.hasLayer(dot)) map.removeLayer(dot);
          if (!map.hasLayer(circle)) map.addLayer(circle);
        } else {
          if (map.hasLayer(circle)) map.removeLayer(circle);
          if (!map.hasLayer(dot)) map.addLayer(dot);
        }
      }

      // Listen for zoom changes
      map.on('zoomend', updateMarkerDisplay);

      // Also call on initial load
      updateMarkerDisplay();

      // Click handler to open in Google Maps
      map.on('click', function() {
        window.open('{{ page.map_url }}', '_blank');
      });
    })();
  </script>
  {% endif %}

  <div class="life-narrative">
    {{ content }}
  </div>

  {% if page.historical_notes %}
  <div class="historical-notes">
    <h2>Historical Context</h2>
    <ul>
      {% for note in page.historical_notes %}
      <li>{{ note }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  <nav class="life-navigation">
    <a href="{{ '/lives' | relative_url }}">← Back to all lives</a>
  </nav>

  <nav class="life-nav-buttons">
    {% assign sorted_lives = site.lives | sort: "birth_year_numeric" %}
    {% assign current_index = -1 %}
    {% for life in sorted_lives %}
      {% if life.url == page.url %}
        {% assign current_index = forloop.index0 %}
      {% endif %}
    {% endfor %}

    {% if current_index > 0 %}
      {% assign prev_index = current_index | minus: 1 %}
      {% assign prev_life = sorted_lives[prev_index] %}
      <a href="{{ prev_life.url | relative_url }}" class="nav-btn">← Previous life</a>
    {% else %}
      <span class="nav-btn disabled">← Previous life</span>
    {% endif %}

    <a href="#" class="nav-btn" id="random-life-btn">Random life</a>

    {% assign next_index = current_index | plus: 1 %}
    {% if next_index < sorted_lives.size %}
      {% assign next_life = sorted_lives[next_index] %}
      <a href="{{ next_life.url | relative_url }}" class="nav-btn">Next life →</a>
    {% else %}
      <span class="nav-btn disabled">Next life →</span>
    {% endif %}
  </nav>

  <script>
    (function() {
      const allLives = [
        {% for life in site.lives %}
          "{{ life.url | relative_url }}"{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ];
      document.getElementById('random-life-btn').addEventListener('click', function(e) {
        e.preventDefault();
        const randomIndex = Math.floor(Math.random() * allLives.length);
        window.location.href = allLives[randomIndex];
      });
    })();
  </script>
</article>
